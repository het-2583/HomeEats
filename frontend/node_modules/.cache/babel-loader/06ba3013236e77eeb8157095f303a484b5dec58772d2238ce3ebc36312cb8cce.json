{"ast":null,"code":"var _jsxFileName = \"/Users/het2583/Desktop/eats/frontend/src/pages/Login.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useNavigate, Link as RouterLink, useLocation } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\nimport { Container, Box, Typography, TextField, Button, Link, Paper, CircularProgress } from '@mui/material';\nimport { login, fetchUserProfile } from '../redux/slices/authSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst validationSchema = Yup.object({\n  username: Yup.string().required('Username is required'),\n  password: Yup.string().required('Password is required')\n});\nconst Login = () => {\n  _s();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const dispatch = useDispatch();\n  const {\n    loading,\n    error\n  } = useSelector(state => state.auth);\n  const formik = useFormik({\n    initialValues: {\n      username: '',\n      password: ''\n    },\n    validationSchema,\n    onSubmit: async values => {\n      try {\n        var _location$state;\n        const result = await dispatch(login(values));\n        if (result.error) {\n          return; // Stop if login failed\n        }\n\n        // Fetch user profile to get user type\n        const profileResult = await dispatch(fetchUserProfile());\n        if (profileResult.error) {\n          return; // Stop if profile fetch failed\n        }\n\n        // Check if there's a redirect path in the location state\n        const redirectTo = (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.redirectTo;\n        if (redirectTo) {\n          navigate(redirectTo);\n          return;\n        }\n\n        // If no redirect path, navigate based on user type\n        switch (profileResult.payload.user_type) {\n          case 'customer':\n            navigate('/customer-dashboard');\n            break;\n          case 'owner':\n            navigate('/owner-dashboard');\n            break;\n          case 'delivery':\n            navigate('/delivery-dashboard');\n            break;\n          default:\n            navigate('/');\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n      }\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"sm\",\n    children: /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        mt: 8,\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        elevation: 3,\n        sx: {\n          p: 4,\n          width: '100%',\n          borderRadius: 2\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          component: \"h1\",\n          variant: \"h4\",\n          align: \"center\",\n          gutterBottom: true,\n          children: \"Login to Home Eats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          component: \"form\",\n          onSubmit: formik.handleSubmit,\n          sx: {\n            mt: 3\n          },\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            fullWidth: true,\n            id: \"username\",\n            name: \"username\",\n            label: \"Username\",\n            value: formik.values.username,\n            onChange: formik.handleChange,\n            error: formik.touched.username && Boolean(formik.errors.username),\n            helperText: formik.touched.username && formik.errors.username,\n            margin: \"normal\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            fullWidth: true,\n            id: \"password\",\n            name: \"password\",\n            label: \"Password\",\n            type: \"password\",\n            value: formik.values.password,\n            onChange: formik.handleChange,\n            error: formik.touched.password && Boolean(formik.errors.password),\n            helperText: formik.touched.password && formik.errors.password,\n            margin: \"normal\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(Typography, {\n            color: \"error\",\n            align: \"center\",\n            sx: {\n              mt: 2\n            },\n            children: error.detail || 'Login failed'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            fullWidth: true,\n            variant: \"contained\",\n            size: \"large\",\n            disabled: loading,\n            sx: {\n              mt: 3,\n              mb: 2\n            },\n            children: loading ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n              size: 24\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 26\n            }, this) : 'Login'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              textAlign: 'center'\n            },\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              children: [\"Don't have an account?\", ' ', /*#__PURE__*/_jsxDEV(Link, {\n                component: RouterLink,\n                to: \"/register\",\n                state: location.state,\n                children: \"Register here\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 144,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"rFVEhMq+ckg74diC942NTzG/dsc=\", false, function () {\n  return [useNavigate, useLocation, useDispatch, useSelector, useFormik];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useNavigate","Link","RouterLink","useLocation","useDispatch","useSelector","useFormik","Yup","Container","Box","Typography","TextField","Button","Paper","CircularProgress","login","fetchUserProfile","jsxDEV","_jsxDEV","validationSchema","object","username","string","required","password","Login","_s","navigate","location","dispatch","loading","error","state","auth","formik","initialValues","onSubmit","values","_location$state","result","profileResult","redirectTo","payload","user_type","console","maxWidth","children","sx","mt","display","flexDirection","alignItems","elevation","p","width","borderRadius","component","variant","align","gutterBottom","fileName","_jsxFileName","lineNumber","columnNumber","handleSubmit","fullWidth","id","name","label","value","onChange","handleChange","touched","Boolean","errors","helperText","margin","type","color","detail","size","disabled","mb","textAlign","to","_c","$RefreshReg$"],"sources":["/Users/het2583/Desktop/eats/frontend/src/pages/Login.js"],"sourcesContent":["import React from 'react';\nimport { useNavigate, Link as RouterLink, useLocation } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useFormik } from 'formik';\nimport * as Yup from 'yup';\nimport {\n  Container,\n  Box,\n  Typography,\n  TextField,\n  Button,\n  Link,\n  Paper,\n  CircularProgress,\n} from '@mui/material';\nimport { login, fetchUserProfile } from '../redux/slices/authSlice';\n\nconst validationSchema = Yup.object({\n  username: Yup.string().required('Username is required'),\n  password: Yup.string().required('Password is required'),\n});\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const dispatch = useDispatch();\n  const { loading, error } = useSelector((state) => state.auth);\n\n  const formik = useFormik({\n    initialValues: {\n      username: '',\n      password: '',\n    },\n    validationSchema,\n    onSubmit: async (values) => {\n      try {\n        const result = await dispatch(login(values));\n        if (result.error) {\n          return; // Stop if login failed\n        }\n        \n        // Fetch user profile to get user type\n        const profileResult = await dispatch(fetchUserProfile());\n        if (profileResult.error) {\n          return; // Stop if profile fetch failed\n        }\n\n        // Check if there's a redirect path in the location state\n        const redirectTo = location.state?.redirectTo;\n        if (redirectTo) {\n          navigate(redirectTo);\n          return;\n        }\n\n        // If no redirect path, navigate based on user type\n        switch (profileResult.payload.user_type) {\n          case 'customer':\n            navigate('/customer-dashboard');\n            break;\n          case 'owner':\n            navigate('/owner-dashboard');\n            break;\n          case 'delivery':\n            navigate('/delivery-dashboard');\n            break;\n          default:\n            navigate('/');\n        }\n      } catch (error) {\n        console.error('Login error:', error);\n      }\n    },\n  });\n\n  return (\n    <Container maxWidth=\"sm\">\n      <Box\n        sx={{\n          mt: 8,\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n        }}\n      >\n        <Paper\n          elevation={3}\n          sx={{\n            p: 4,\n            width: '100%',\n            borderRadius: 2,\n          }}\n        >\n          <Typography component=\"h1\" variant=\"h4\" align=\"center\" gutterBottom>\n            Login to Home Eats\n          </Typography>\n\n          <Box\n            component=\"form\"\n            onSubmit={formik.handleSubmit}\n            sx={{ mt: 3 }}\n          >\n            <TextField\n              fullWidth\n              id=\"username\"\n              name=\"username\"\n              label=\"Username\"\n              value={formik.values.username}\n              onChange={formik.handleChange}\n              error={formik.touched.username && Boolean(formik.errors.username)}\n              helperText={formik.touched.username && formik.errors.username}\n              margin=\"normal\"\n            />\n\n            <TextField\n              fullWidth\n              id=\"password\"\n              name=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              value={formik.values.password}\n              onChange={formik.handleChange}\n              error={formik.touched.password && Boolean(formik.errors.password)}\n              helperText={formik.touched.password && formik.errors.password}\n              margin=\"normal\"\n            />\n\n            {error && (\n              <Typography color=\"error\" align=\"center\" sx={{ mt: 2 }}>\n                {error.detail || 'Login failed'}\n              </Typography>\n            )}\n\n            <Button\n              type=\"submit\"\n              fullWidth\n              variant=\"contained\"\n              size=\"large\"\n              disabled={loading}\n              sx={{ mt: 3, mb: 2 }}\n            >\n              {loading ? <CircularProgress size={24} /> : 'Login'}\n            </Button>\n\n            <Box sx={{ textAlign: 'center' }}>\n              <Typography variant=\"body2\">\n                Don't have an account?{' '}\n                <Link \n                  component={RouterLink} \n                  to=\"/register\" \n                  state={location.state}\n                >\n                  Register here\n                </Link>\n              </Typography>\n            </Box>\n          </Box>\n        </Paper>\n      </Box>\n    </Container>\n  );\n};\n\nexport default Login; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}